# プロダクトコンテキスト: Blokus Duo

## 解決する問題

Blokusプロジェクトは以下の問題を解決します：

1. **強化学習エージェント開発環境の提供**：OpenAI Gym互換の環境を通じて、効率的な強化学習エージェント開発を可能にします。
2. **ゲームロジックの複雑性管理**：Blokus Duoの複雑なルールと状態管理を明確に構造化し、強化学習に適した形で提供します。
3. **型安全な開発環境**：Python 3.12の型ヒントとpyrightにより、安全で保守性の高いコードベースを実現します。
4. **再現性の確保**：テスト駆動開発（TDD）とdevcontainer+uvによる環境管理を通じて、バグの少ない堅牢な環境を作成します。
5. **コード品質の向上**：ruffを活用した統合的なコード品質管理により、一貫性のある高品質なコードベースを実現します。

## 環境の価値

Blokus Duo環境は以下の価値を提供します：

- **強化学習研究の促進**：2人対戦の戦略ゲームにおける強化学習アルゴリズムの研究を促進します。
- **標準化されたインターフェース**：OpenAI Gym互換のインターフェースにより、様々な強化学習アルゴリズムとの連携を容易にします。
- **高い拡張性**：基本環境から始め、必要に応じて可視化や追加機能を拡張できます。
- **戦略的思考の学習**：エージェントの空間認識能力と戦略的思考の学習を可能にします。
- **対戦型学習の研究**：2人対戦環境により、対戦型強化学習の研究を促進します。

## 開発者体験目標

このプロジェクトでは、以下の開発者体験を目指します：

1. **シンプルなインターフェース**：標準的なOpenAI Gymインターフェースに準拠し、学習曲線を最小化します。
2. **明確な観測空間と行動空間**：エージェント開発に必要な情報が適切に提供されます。
3. **効率的なシミュレーション**：多数の試行を高速に実行できる効率的な実装を提供します。
4. **適切なフィードバック**：報酬関数を通じてエージェントの学習を促進します。
5. **拡張可能な可視化**：必要に応じてゲーム状態を可視化し、エージェントの行動を分析できます。

## 開発アプローチ

開発は以下のアプローチで進めます：

1. **Python 3.12での実装**：最新のPython機能を活用し、言語間連携の問題を解消します。
2. **テストファースト**：常に失敗するテストから始め、テスト駆動で開発を進めます。
3. **型ヒントの活用**：Python 3.12の型ヒントとpyrightによる静的型チェックにより、コードの安全性を確保します。
4. **devcontainer+uvによる環境管理**：一貫した開発環境と依存関係管理を実現します。
5. **ruffによるコード品質管理**：リンティング、フォーマット、インポート順序の最適化を統合的に行います。
6. **継続的改善**：コードを継続的にリファクタリングして改善します。

## 環境仕様

Blokus Duo環境は以下の仕様に基づいて実装されます：

### ゲームルール
- 2人プレイ（各プレイヤーは異なる色のピースを使用）
- 14x14のボードサイズ（通常の20x20より小さい）
- 各プレイヤーは21種類のポリオミノピースを持つ
- スタート位置は盤面の対角線上の5マス目から開始
- 新しいピースは自分の色のピースの角に接するように配置する
- 自分の色のピースの辺に接するように配置することはできない
- 最もピースを多く配置したプレイヤーが勝利

### 環境インターフェース
- OpenAI Gym互換のインターフェース
- 観測空間：
  - ボード状態（14x14）
  - 利用可能なピース（2プレイヤー×21ピース）
  - 現在のプレイヤー情報
- 行動空間：ピース選択、配置位置、回転/反転
- 報酬関数：配置したピースのサイズ、ゲーム終了時の最終スコア

### 強化学習連携
- StableBaselines3との互換性
- カスタムポリシーネットワークのサポート
- 対戦型学習のサポート
- 自己対戦学習の可能性

## 成功指標

プロジェクトの成功は以下の指標で測定します：

- 環境のテストカバレッジ
- OpenAI Gym互換性の完全性
- Blokus Duoルール適用の正確性
- 強化学習エージェントの学習効率
- 対戦型学習の効果
- シミュレーション速度と効率性
- Python 3.12の型安全性の確保
- ruffによるコード品質の一貫性
- devcontainer+uvによる環境の再現性
- コードの保守性と拡張性

このプロダクトコンテキストは、Blokus Duoプロジェクトの「なぜ」と「何を」を定義し、開発の方向性を示すものです。テスト駆動開発の価値と原則については、共有メモリバンクの`systemPatterns.md`を参照してください。
